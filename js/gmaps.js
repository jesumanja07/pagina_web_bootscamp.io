"use strict";!function(c,d){"object"==typeof exports?module.exports=d():"function"==typeof define&&define.amd&&define("GMaps",[],d),c.GMaps=d()}(this,function(){if("object"!=typeof window.google||!window.google.maps){throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true."}var m=function(d,f){var g;if(d===f){return d}for(g in f){d[g]=f[g]}return d},n=function(g,h){var i,j=Array.prototype.slice.call(arguments,2),k=[],l=g.length;if(Array.prototype.map&&g.map===Array.prototype.map){k=Array.prototype.map.call(g,function(b){var d=j.slice(0);return d.splice(0,0,b),h.apply(this,d)})}else{for(i=0;l>i;i++){callback_params=j,callback_params.splice(0,0,g[i]),k.push(h.apply(this,callback_params))}}return k},o=function(d){var f,g=[];for(f=0;f<d.length;f++){g=g.concat(d[f])}return g},p=function(f,g){var h=f[0],i=f[1];return g&&(h=f[1],i=f[0]),new google.maps.LatLng(h,i)},q=function(d,f){var g;for(g=0;g<d.length;g++){d[g] instanceof google.maps.LatLng||(d[g].length>0&&"object"==typeof d[g][0]?d[g]=q(d[g],f):d[g]=p(d[g],f))}return d},r=function(f,g){var h,i=f.replace(".","");return h="jQuery" in this&&g?$("."+i,g)[0]:document.getElementsByClassName(i)[0]},s=function(d,f){var g,d=d.replace("#","");return g="jQuery" in window&&f?$("#"+d,f)[0]:document.getElementById(d)},t=function(d){var f=0,g=0;if(d.offsetParent){do{f+=d.offsetLeft,g+=d.offsetTop}while(d=d.offsetParent)}return[f,g]},u=function(a){var f=document,g=function(d){if(!this){return new g(d)}d.zoom=d.zoom||15,d.mapType=d.mapType||"roadmap";var J,L=this,P=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],Q=["mousemove","mouseout","mouseover"],R=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],S=d.el||d.div,T=d.markerClusterer,U=google.maps.MapTypeId[d.mapType.toUpperCase()],V=new google.maps.LatLng(d.lat,d.lng),W=d.zoomControl||!0,X=d.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},Y=X.style||"DEFAULT",Z=X.position||"TOP_LEFT",aa=d.panControl||!0,ab=d.mapTypeControl||!0,ac=d.scaleControl||!0,ad=d.streetViewControl||!0,ae=ae||!0,af={},c={zoom:this.zoom,center:V,mapTypeId:U},h={panControl:aa,zoomControl:W,zoomControlOptions:{style:google.maps.ZoomControlStyle[Y],position:google.maps.ControlPosition[Z]},mapTypeControl:ab,scaleControl:ac,streetViewControl:ad,overviewMapControl:ae};if("string"==typeof d.el||"string"==typeof d.div?S.indexOf("#")>-1?this.el=s(S,d.context):this.el=r.apply(this,[S,d.context]):this.el=S,"undefined"==typeof this.el||null===this.el){throw"No element defined."}for(window.context_menu=window.context_menu||{},window.context_menu[L.el.id]={},this.controls=[],this.overlays=[],this.layers=[],this.singleLayers={},this.markers=[],this.polylines=[],this.routes=[],this.polygons=[],this.infoWindow=null,this.overlay_el=null,this.zoom=d.zoom,this.registered_events={},this.el.style.width=d.width||this.el.scrollWidth||this.el.offsetWidth,this.el.style.height=d.height||this.el.scrollHeight||this.el.offsetHeight,google.maps.visualRefresh=d.enableNewStyle,J=0;J<R.length;J++){delete d[R[J]]}for(1!=d.disableDefaultUI&&(c=m(c,h)),af=m(c,d),J=0;J<P.length;J++){delete af[P[J]]}for(J=0;J<Q.length;J++){delete af[Q[J]]}this.map=new google.maps.Map(this.el,af),T&&(this.markerClusterer=T.apply(this,[this.map]));var i=function(x,y){var z="",A=window.context_menu[L.el.id][x];for(var B in A){if(A.hasOwnProperty(B)){var C=A[B];z+='<li><a id="'+x+"_"+B+'" href="#">'+C.title+"</a></li>"}}if(s("gmaps_context_menu")){var D=s("gmaps_context_menu");D.innerHTML=z;var B,E=D.getElementsByTagName("a"),F=E.length;for(B=0;F>B;B++){var G=E[B],H=function(b){b.preventDefault(),A[this.id.replace(x+"_","")].action.apply(L,[y]),L.hideContextMenu()};google.maps.event.clearListeners(G,"click"),google.maps.event.addDomListenerOnce(G,"click",H,!1)}var ag=t.apply(this,[L.el]),ah=ag[0]+y.pixel.x-15,ai=ag[1]+y.pixel.y-15;D.style.left=ah+"px",D.style.top=ai+"px",D.style.display="block"}};this.buildContextMenu=function(j,k){if("marker"===j){k.pixel={};var l=new google.maps.OverlayView;l.setMap(L.map),l.draw=function(){var b=l.getProjection(),x=k.marker.getPosition();k.pixel=b.fromLatLngToContainerPixel(x),i(j,k)}}else{i(j,k)}},this.setContextMenu=function(j){window.context_menu[L.el.id][j.control]={};var k,l=f.createElement("ul");for(k in j.options){if(j.options.hasOwnProperty(k)){var x=j.options[k];window.context_menu[L.el.id][j.control][x.name]={title:x.title,action:x.action}}}l.id="gmaps_context_menu",l.style.display="none",l.style.position="absolute",l.style.minWidth="100px",l.style.background="white",l.style.listStyle="none",l.style.padding="8px",l.style.boxShadow="2px 2px 6px #ccc",f.body.appendChild(l);var y=s("gmaps_context_menu");google.maps.event.addDomListener(y,"mouseout",function(b){b.relatedTarget&&this.contains(b.relatedTarget)||window.setTimeout(function(){y.style.display="none"},400)},!1)},this.hideContextMenu=function(){var b=s("gmaps_context_menu");b&&(b.style.display="none")};var I=function(b,j){google.maps.event.addListener(b,j,function(k){void 0==k&&(k=this),d[j].apply(this,[k]),L.hideContextMenu()})};google.maps.event.addListener(this.map,"zoom_changed",this.hideContextMenu);for(var K=0;K<P.length;K++){var M=P[K];M in d&&I(this.map,M)}for(var K=0;K<Q.length;K++){var M=Q[K];M in d&&I(this.map,M)}google.maps.event.addListener(this.map,"rightclick",function(b){d.rightclick&&d.rightclick.apply(this,[b]),void 0!=window.context_menu[L.el.id].map&&L.buildContextMenu("map",b)}),this.refresh=function(){google.maps.event.trigger(this.map,"resize")},this.fitZoom=function(){var j,k=[],l=this.markers.length;for(j=0;l>j;j++){"boolean"==typeof this.markers[j].visible&&this.markers[j].visible&&k.push(this.markers[j].getPosition())}this.fitLatLngBounds(k)},this.fitLatLngBounds=function(j){var k,l=j.length,x=new google.maps.LatLngBounds;for(k=0;l>k;k++){x.extend(j[k])}this.map.fitBounds(x)},this.setCenter=function(j,k,l){this.map.panTo(new google.maps.LatLng(j,k)),l&&l()},this.getElement=function(){return this.el},this.zoomIn=function(b){b=b||1,this.zoom=this.map.getZoom()+b,this.map.setZoom(this.zoom)},this.zoomOut=function(b){b=b||1,this.zoom=this.map.getZoom()-b,this.map.setZoom(this.zoom)};var N,O=[];for(N in this.map){"function"!=typeof this.map[N]||this[N]||O.push(N)}for(J=0;J<O.length;J++){!function(j,k,l){j[l]=function(){return k[l].apply(k,arguments)}}(this,this.map,O[J])}};return g}(this);u.prototype.createControl=function(f){var g=document.createElement("div");g.style.cursor="pointer",f.disableDefaultStyles!==!0&&(g.style.fontFamily="Roboto, Arial, sans-serif",g.style.fontSize="11px",g.style.boxShadow="rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px");for(var h in f.style){g.style[h]=f.style[h]}f.id&&(g.id=f.id),f.classes&&(g.className=f.classes),f.content&&("string"==typeof f.content?g.innerHTML=f.content:f.content instanceof HTMLElement&&g.appendChild(f.content)),f.position&&(g.position=google.maps.ControlPosition[f.position.toUpperCase()]);for(var i in f.events){!function(a,d){google.maps.event.addDomListener(a,d,function(){f.events[d].apply(this,[this])})}(g,i)}return g.index=1,g},u.prototype.addControl=function(c){var d=this.createControl(c);return this.controls.push(d),this.map.controls[d.position].push(d),d},u.prototype.removeControl=function(f){var g,h=null;for(g=0;g<this.controls.length;g++){this.controls[g]==f&&(h=this.controls[g].position,this.controls.splice(g,1))}if(h){for(g=0;g<this.map.controls.length;g++){var i=this.map.controls[f.position];if(i.getAt(g)==f){i.removeAt(g);break}}}return f},u.prototype.createMarker=function(a){if(void 0==a.lat&&void 0==a.lng&&void 0==a.position){throw"No latitude or longitude defined."}var x=this,y=a.details,z=a.fences,A=a.outside,B={position:new google.maps.LatLng(a.lat,a.lng),map:null},C=m(B,a);delete C.lat,delete C.lng,delete C.fences,delete C.outside;var D=new google.maps.Marker(C);if(D.fences=z,a.infoWindow){D.infoWindow=new google.maps.InfoWindow(a.infoWindow);for(var E=["closeclick","content_changed","domready","position_changed","zindex_changed"],F=0;F<E.length;F++){!function(b,d){a.infoWindow[d]&&google.maps.event.addListener(b,d,function(c){a.infoWindow[d].apply(this,[c])})}(D.infoWindow,E[F])}}for(var G=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],H=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"],F=0;F<G.length;F++){!function(b,d){a[d]&&google.maps.event.addListener(b,d,function(){a[d].apply(this,[this])})}(D,G[F])}for(var F=0;F<H.length;F++){!function(b,f,g){a[g]&&google.maps.event.addListener(f,g,function(d){d.pixel||(d.pixel=b.getProjection().fromLatLngToPoint(d.latLng)),a[g].apply(this,[d])})}(this.map,D,H[F])}return google.maps.event.addListener(D,"click",function(){this.details=y,a.click&&a.click.apply(this,[this]),D.infoWindow&&(x.hideInfoWindows(),D.infoWindow.open(x.map,D))}),google.maps.event.addListener(D,"rightclick",function(b){b.marker=this,a.rightclick&&a.rightclick.apply(this,[b]),void 0!=window.context_menu[x.el.id].marker&&x.buildContextMenu("marker",b)}),D.fences&&google.maps.event.addListener(D,"dragend",function(){x.checkMarkerGeofence(D,function(c,d){A(c,d)})}),D},u.prototype.addMarker=function(c){var d;if(c.hasOwnProperty("gm_accessors_")){d=c}else{if(!(c.hasOwnProperty("lat")&&c.hasOwnProperty("lng")||c.position)){throw"No latitude or longitude defined."}d=this.createMarker(c)}return d.setMap(this.map),this.markerClusterer&&this.markerClusterer.addMarker(d),this.markers.push(d),u.fire("marker_added",d,this),d},u.prototype.addMarkers=function(d){for(var f,g=0;f=d[g];g++){this.addMarker(f)}return this.markers},u.prototype.hideInfoWindows=function(){for(var c,d=0;c=this.markers[d];d++){c.infoWindow&&c.infoWindow.close()}},u.prototype.removeMarker=function(c){for(var d=0;d<this.markers.length;d++){if(this.markers[d]===c){this.markers[d].setMap(null),this.markers.splice(d,1),this.markerClusterer&&this.markerClusterer.removeMarker(c),u.fire("marker_removed",c,this);break}}return c},u.prototype.removeMarkers=function(f){var g=[];if("undefined"==typeof f){for(var h=0;h<this.markers.length;h++){var i=this.markers[h];i.setMap(null),this.markerClusterer&&this.markerClusterer.removeMarker(i),u.fire("marker_removed",i,this)}this.markers=g}else{for(var h=0;h<f.length;h++){var j=this.markers.indexOf(f[h]);if(j>-1){var i=this.markers[j];i.setMap(null),this.markerClusterer&&this.markerClusterer.removeMarker(i),u.fire("marker_removed",i,this)}}for(var h=0;h<this.markers.length;h++){var i=this.markers[h];null!=i.getMap()&&g.push(i)}this.markers=g}},u.prototype.drawOverlay=function(d){var f=new google.maps.OverlayView,g=!0;return f.setMap(this.map),null!=d.auto_show&&(g=d.auto_show),f.onAdd=function(){var a=document.createElement("div");a.style.borderStyle="none",a.style.borderWidth="0px",a.style.position="absolute",a.style.zIndex=100,a.innerHTML=d.content,f.el=a,d.layer||(d.layer="overlayLayer");var b=this.getPanes(),h=b[d.layer],i=["contextmenu","DOMMouseScroll","dblclick","mousedown"];h.appendChild(a);for(var j=0;j<i.length;j++){!function(c,k){google.maps.event.addDomListener(c,k,function(l){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&document.all?(l.cancelBubble=!0,l.returnValue=!1):l.stopPropagation()})}(a,i[j])}d.click&&(b.overlayMouseTarget.appendChild(f.el),google.maps.event.addDomListener(f.el,"click",function(){d.click.apply(f,[f])})),google.maps.event.trigger(this,"ready")},f.draw=function(){var a=this.getProjection(),b=a.fromLatLngToDivPixel(new google.maps.LatLng(d.lat,d.lng));d.horizontalOffset=d.horizontalOffset||0,d.verticalOffset=d.verticalOffset||0;var c=f.el,j=c.children[0],k=j.clientHeight,l=j.clientWidth;switch(d.verticalAlign){case"top":c.style.top=b.y-k+d.verticalOffset+"px";break;default:case"middle":c.style.top=b.y-k/2+d.verticalOffset+"px";break;case"bottom":c.style.top=b.y+d.verticalOffset+"px"}switch(d.horizontalAlign){case"left":c.style.left=b.x-l+d.horizontalOffset+"px";break;default:case"center":c.style.left=b.x-l/2+d.horizontalOffset+"px";break;case"right":c.style.left=b.x+d.horizontalOffset+"px"}c.style.display=g?"block":"none",g||d.show.apply(this,[c])},f.onRemove=function(){var a=f.el;d.remove?d.remove.apply(this,[a]):(f.el.parentNode.removeChild(f.el),f.el=null)},this.overlays.push(f),f},u.prototype.removeOverlay=function(c){for(var d=0;d<this.overlays.length;d++){if(this.overlays[d]===c){this.overlays[d].setMap(null),this.overlays.splice(d,1);break}}},u.prototype.removeOverlays=function(){for(var c,d=0;c=this.overlays[d];d++){c.setMap(null)}this.overlays=[]},u.prototype.drawPolyline=function(j){var k=[],l=j.path;if(l.length){if(void 0===l[0][0]){k=l}else{for(var x,y=0;x=l[y];y++){k.push(new google.maps.LatLng(x[0],x[1]))}}}var z={map:this.map,path:k,strokeColor:j.strokeColor,strokeOpacity:j.strokeOpacity,strokeWeight:j.strokeWeight,geodesic:j.geodesic,clickable:!0,editable:!1,visible:!0};j.hasOwnProperty("clickable")&&(z.clickable=j.clickable),j.hasOwnProperty("editable")&&(z.editable=j.editable),j.hasOwnProperty("icons")&&(z.icons=j.icons),j.hasOwnProperty("zIndex")&&(z.zIndex=j.zIndex);for(var A=new google.maps.Polyline(z),B=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],C=0;C<B.length;C++){!function(a,d){j[d]&&google.maps.event.addListener(a,d,function(c){j[d].apply(this,[c])})}(A,B[C])}return this.polylines.push(A),u.fire("polyline_added",A,this),A},u.prototype.removePolyline=function(c){for(var d=0;d<this.polylines.length;d++){if(this.polylines[d]===c){this.polylines[d].setMap(null),this.polylines.splice(d,1),u.fire("polyline_removed",c,this);break}}},u.prototype.removePolylines=function(){for(var c,d=0;c=this.polylines[d];d++){c.setMap(null)}this.polylines=[]},u.prototype.drawCircle=function(a){a=m({map:this.map,center:new google.maps.LatLng(a.lat,a.lng)},a),delete a.lat,delete a.lng;for(var f=new google.maps.Circle(a),g=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],h=0;h<g.length;h++){!function(b,d){a[d]&&google.maps.event.addListener(b,d,function(c){a[d].apply(this,[c])})}(f,g[h])}return this.polygons.push(f),f},u.prototype.drawRectangle=function(a){a=m({map:this.map},a);var g=new google.maps.LatLngBounds(new google.maps.LatLng(a.bounds[0][0],a.bounds[0][1]),new google.maps.LatLng(a.bounds[1][0],a.bounds[1][1]));a.bounds=g;for(var h=new google.maps.Rectangle(a),i=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],j=0;j<i.length;j++){!function(b,d){a[d]&&google.maps.event.addListener(b,d,function(c){a[d].apply(this,[c])})}(h,i[j])}return this.polygons.push(h),h},u.prototype.drawPolygon=function(a){var b=!1;a.hasOwnProperty("useGeoJSON")&&(b=a.useGeoJSON),delete a.useGeoJSON,a=m({map:this.map},a),0==b&&(a.paths=[a.paths.slice(0)]),a.paths.length>0&&a.paths[0].length>0&&(a.paths=o(n(a.paths,q,b)));for(var c=new google.maps.Polygon(a),f=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],j=0;j<f.length;j++){!function(d,g){a[g]&&google.maps.event.addListener(d,g,function(h){a[g].apply(this,[h])})}(c,f[j])}return this.polygons.push(c),u.fire("polygon_added",c,this),c},u.prototype.removePolygon=function(c){for(var d=0;d<this.polygons.length;d++){if(this.polygons[d]===c){this.polygons[d].setMap(null),this.polygons.splice(d,1),u.fire("polygon_removed",c,this);break}}},u.prototype.removePolygons=function(){for(var c,d=0;c=this.polygons[d];d++){c.setMap(null)}this.polygons=[]},u.prototype.getFromFusionTables=function(f){var g=f.events;delete f.events;var h=f,i=new google.maps.FusionTablesLayer(h);for(var j in g){!function(b,d){google.maps.event.addListener(b,d,function(c){g[d].apply(this,[c])})}(i,j)}return this.layers.push(i),i},u.prototype.loadFromFusionTables=function(c){var d=this.getFromFusionTables(c);return d.setMap(this.map),d},u.prototype.getFromKML=function(g){var h=g.url,i=g.events;delete g.url,delete g.events;var j=g,k=new google.maps.KmlLayer(h,j);for(var l in i){!function(c,d){google.maps.event.addListener(c,d,function(b){i[d].apply(this,[b])})}(k,l)}return this.layers.push(k),k},u.prototype.loadFromKML=function(c){var d=this.getFromKML(c);return d.setMap(this.map),d},u.prototype.addLayer=function(f,g){g=g||{};var h;switch(f){case"weather":this.singleLayers.weather=h=new google.maps.weather.WeatherLayer;break;case"clouds":this.singleLayers.clouds=h=new google.maps.weather.CloudLayer;break;case"traffic":this.singleLayers.traffic=h=new google.maps.TrafficLayer;break;case"transit":this.singleLayers.transit=h=new google.maps.TransitLayer;break;case"bicycling":this.singleLayers.bicycling=h=new google.maps.BicyclingLayer;break;case"panoramio":this.singleLayers.panoramio=h=new google.maps.panoramio.PanoramioLayer,h.setTag(g.filter),delete g.filter,g.click&&google.maps.event.addListener(h,"click",function(b){g.click(b),delete g.click});break;case"places":if(this.singleLayers.places=h=new google.maps.places.PlacesService(this.map),g.search||g.nearbySearch||g.radarSearch){var i={bounds:g.bounds||null,keyword:g.keyword||null,location:g.location||null,name:g.name||null,radius:g.radius||null,rankBy:g.rankBy||null,types:g.types||null};g.radarSearch&&h.radarSearch(i,g.radarSearch),g.search&&h.search(i,g.search),g.nearbySearch&&h.nearbySearch(i,g.nearbySearch)}if(g.textSearch){var j={bounds:g.bounds||null,location:g.location||null,query:g.query||null,radius:g.radius||null};h.textSearch(j,g.textSearch)}}return void 0!==h?("function"==typeof h.setOptions&&h.setOptions(g),"function"==typeof h.setMap&&h.setMap(this.map),h):void 0},u.prototype.removeLayer=function(c){if("string"==typeof c&&void 0!==this.singleLayers[c]){this.singleLayers[c].setMap(null),delete this.singleLayers[c]}else{for(var d=0;d<this.layers.length;d++){if(this.layers[d]===c){this.layers[d].setMap(null),this.layers.splice(d,1);break}}}};var v,w;return u.prototype.getRoutes=function(a){switch(a.travelMode){case"bicycling":v=google.maps.TravelMode.BICYCLING;break;case"transit":v=google.maps.TravelMode.TRANSIT;break;case"driving":v=google.maps.TravelMode.DRIVING;break;default:v=google.maps.TravelMode.WALKING}w="imperial"===a.unitSystem?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;var g={avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]},h=m(g,a);h.origin=/string/.test(typeof a.origin)?a.origin:new google.maps.LatLng(a.origin[0],a.origin[1]),h.destination=/string/.test(typeof a.destination)?a.destination:new google.maps.LatLng(a.destination[0],a.destination[1]),h.travelMode=v,h.unitSystem=w,delete h.callback,delete h.error;var i=this,j=new google.maps.DirectionsService;j.route(h,function(b,f){if(f===google.maps.DirectionsStatus.OK){for(var k in b.routes){b.routes.hasOwnProperty(k)&&i.routes.push(b.routes[k])}a.callback&&a.callback(i.routes)}else{a.error&&a.error(b,f)}})},u.prototype.removeRoutes=function(){this.routes=[]},u.prototype.getElevations=function(a){a=m({locations:[],path:!1,samples:256},a),a.locations.length>0&&a.locations[0].length>0&&(a.locations=o(n([a.locations],q,!1)));var b=a.callback;delete a.callback;var c=new google.maps.ElevationService;if(a.path){var f={path:a.locations,samples:a.samples};c.getElevationAlongPath(f,function(d,g){b&&"function"==typeof b&&b(d,g)})}else{delete a.path,delete a.samples,c.getElevationForLocations(a,function(d,g){b&&"function"==typeof b&&b(d,g)})}},u.prototype.cleanRoute=u.prototype.removePolylines,u.prototype.drawRoute=function(c){var d=this;this.getRoutes({origin:c.origin,destination:c.destination,travelMode:c.travelMode,waypoints:c.waypoints,unitSystem:c.unitSystem,error:c.error,callback:function(a){if(a.length>0){var b={path:a[a.length-1].overview_path,strokeColor:c.strokeColor,strokeOpacity:c.strokeOpacity,strokeWeight:c.strokeWeight};c.hasOwnProperty("icons")&&(b.icons=c.icons),d.drawPolyline(b),c.callback&&c.callback(a[a.length-1])}}})},u.prototype.travelRoute=function(f){if(f.origin&&f.destination){this.getRoutes({origin:f.origin,destination:f.destination,travelMode:f.travelMode,waypoints:f.waypoints,unitSystem:f.unitSystem,error:f.error,callback:function(a){if(a.length>0&&f.start&&f.start(a[a.length-1]),a.length>0&&f.step){var j=a[a.length-1];if(j.legs.length>0){for(var k,l=j.legs[0].steps,x=0;k=l[x];x++){k.step_number=x,f.step(k,j.legs[0].steps.length-1)}}}a.length>0&&f.end&&f.end(a[a.length-1])}})}else{if(f.route&&f.route.legs.length>0){for(var g,h=f.route.legs[0].steps,i=0;g=h[i];i++){g.step_number=i,f.step(g)}}}},u.prototype.drawSteppedRoute=function(g){var h=this;if(g.origin&&g.destination){this.getRoutes({origin:g.origin,destination:g.destination,travelMode:g.travelMode,waypoints:g.waypoints,error:g.error,callback:function(a){if(a.length>0&&g.start&&g.start(a[a.length-1]),a.length>0&&g.step){var b=a[a.length-1];if(b.legs.length>0){for(var x,y=b.legs[0].steps,z=0;x=y[z];z++){x.step_number=z;var A={path:x.path,strokeColor:g.strokeColor,strokeOpacity:g.strokeOpacity,strokeWeight:g.strokeWeight};g.hasOwnProperty("icons")&&(A.icons=g.icons),h.drawPolyline(A),g.step(x,b.legs[0].steps.length-1)}}}a.length>0&&g.end&&g.end(a[a.length-1])}})}else{if(g.route&&g.route.legs.length>0){for(var i,j=g.route.legs[0].steps,k=0;i=j[k];k++){i.step_number=k;var l={path:i.path,strokeColor:g.strokeColor,strokeOpacity:g.strokeOpacity,strokeWeight:g.strokeWeight};g.hasOwnProperty("icons")&&(l.icons=g.icons),h.drawPolyline(l),g.step(i)}}}},u.Route=function(c){this.origin=c.origin,this.destination=c.destination,this.waypoints=c.waypoints,this.map=c.map,this.route=c.route,this.step_count=0,this.steps=this.route.legs[0].steps,this.steps_length=this.steps.length;var d={path:new google.maps.MVCArray,strokeColor:c.strokeColor,strokeOpacity:c.strokeOpacity,strokeWeight:c.strokeWeight};c.hasOwnProperty("icons")&&(d.icons=c.icons),this.polyline=this.map.drawPolyline(d).getPath()},u.Route.prototype.getRoute=function(c){var d=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:c.travelMode,waypoints:this.waypoints||[],error:c.error,callback:function(){d.route=e[0],c.callback&&c.callback.call(d)}})},u.Route.prototype.back=function(){if(this.step_count>0){this.step_count--;var c=this.route.legs[0].steps[this.step_count].path;for(var d in c){c.hasOwnProperty(d)&&this.polyline.pop()}}},u.Route.prototype.forward=function(){if(this.step_count<this.steps_length){var c=this.route.legs[0].steps[this.step_count].path;for(var d in c){c.hasOwnProperty(d)&&this.polyline.push(c[d])}this.step_count++}},u.prototype.checkGeofence=function(d,f,g){return g.containsLatLng(new google.maps.LatLng(d,f))},u.prototype.checkMarkerGeofence=function(f,g){if(f.fences){for(var h,i=0;h=f.fences[i];i++){var j=f.getPosition();this.checkGeofence(j.lat(),j.lng(),h)||g(f,h)}}},u.prototype.toImage=function(f){var f=f||{},g={};if(g.size=f.size||[this.el.clientWidth,this.el.clientHeight],g.lat=this.getCenter().lat(),g.lng=this.getCenter().lng(),this.markers.length>0){g.markers=[];for(var h=0;h<this.markers.length;h++){g.markers.push({lat:this.markers[h].getPosition().lat(),lng:this.markers[h].getPosition().lng()})}}if(this.polylines.length>0){var i=this.polylines[0];g.polyline={},g.polyline.path=google.maps.geometry.encoding.encodePath(i.getPath()),g.polyline.strokeColor=i.strokeColor,g.polyline.strokeOpacity=i.strokeOpacity,g.polyline.strokeWeight=i.strokeWeight}return u.staticMapURL(g)},u.staticMapURL=function(z){function A(c,d){if("#"===c[0]&&(c=c.replace("#","0x"),d)){if(d=parseFloat(d),d=Math.min(1,Math.max(d,0)),0===d){return"0x00000000"}d=(255*d).toString(16),1===d.length&&(d+=d),c=c.slice(0,8)+d}return c}var B,C=[],D=("file:"===location.protocol?"http:":location.protocol)+"//maps.googleapis.com/maps/api/staticmap";z.url&&(D=z.url,delete z.url),D+="?";var E=z.markers;delete z.markers,!E&&z.marker&&(E=[z.marker],delete z.marker);var F=z.styles;delete z.styles;var G=z.polyline;if(delete z.polyline,z.center){C.push("center="+z.center),delete z.center}else{if(z.address){C.push("center="+z.address),delete z.address}else{if(z.lat){C.push(["center=",z.lat,",",z.lng].join("")),delete z.lat,delete z.lng}else{if(z.visible){var H=encodeURI(z.visible.join("|"));C.push("visible="+H)}}}}var I=z.size;I?(I.join&&(I=I.join("x")),delete z.size):I="630x300",C.push("size="+I),z.zoom||z.zoom===!1||(z.zoom=15);var J=z.hasOwnProperty("sensor")?!!z.sensor:!0;delete z.sensor,C.push("sensor="+J);for(var K in z){z.hasOwnProperty(K)&&C.push(K+"="+z[K])}if(E){for(var L,M,N=0;B=E[N];N++){L=[],B.size&&"normal"!==B.size?(L.push("size:"+B.size),delete B.size):B.icon&&(L.push("icon:"+encodeURI(B.icon)),delete B.icon),B.color&&(L.push("color:"+B.color.replace("#","0x")),delete B.color),B.label&&(L.push("label:"+B.label[0].toUpperCase()),delete B.label),M=B.address?B.address:B.lat+","+B.lng,delete B.address,delete B.lat,delete B.lng;for(var K in B){B.hasOwnProperty(K)&&L.push(K+":"+B[K])}L.length||0===N?(L.push(M),L=L.join("|"),C.push("markers="+encodeURI(L))):(L=C.pop()+encodeURI("|"+M),C.push(L))}}if(F){for(var N=0;N<F.length;N++){var O=[];F[N].featureType&&O.push("feature:"+F[N].featureType.toLowerCase()),F[N].elementType&&O.push("element:"+F[N].elementType.toLowerCase());for(var P=0;P<F[N].stylers.length;P++){for(var Q in F[N].stylers[P]){var R=F[N].stylers[P][Q];("hue"==Q||"color"==Q)&&(R="0x"+R.substring(1)),O.push(Q+":"+R)}}var S=O.join("|");""!=S&&C.push("style="+S)}}if(G){if(B=G,G=[],B.strokeWeight&&G.push("weight:"+parseInt(B.strokeWeight,10)),B.strokeColor){var T=A(B.strokeColor,B.strokeOpacity);G.push("color:"+T)}if(B.fillColor){var U=A(B.fillColor,B.fillOpacity);G.push("fillcolor:"+U)}var V=B.path;if(V.join){for(var W,P=0;W=V[P];P++){G.push(W.join(","))}}else{G.push("enc:"+V)}G=G.join("|"),C.push("path="+encodeURI(G))}var X=window.devicePixelRatio||1;return C.push("scale="+X),C=C.join("&"),D+C},u.prototype.addMapType=function(d,f){if(!f.hasOwnProperty("getTileUrl")||"function"!=typeof f.getTileUrl){throw"'getTileUrl' function required."}f.tileSize=f.tileSize||new google.maps.Size(256,256);var g=new google.maps.ImageMapType(f);this.map.mapTypes.set(d,g)},u.prototype.addOverlayMapType=function(c){if(!c.hasOwnProperty("getTile")||"function"!=typeof c.getTile){throw"'getTile' function required."}var d=c.index;delete c.index,this.map.overlayMapTypes.insertAt(d,c)},u.prototype.removeOverlayMapType=function(b){this.map.overlayMapTypes.removeAt(b)},u.prototype.addStyle=function(c){var d=new google.maps.StyledMapType(c.styles,{name:c.styledMapName});this.map.mapTypes.set(c.mapTypeId,d)},u.prototype.setStyle=function(b){this.map.setMapTypeId(b)},u.prototype.createPanorama=function(b){return b.hasOwnProperty("lat")&&b.hasOwnProperty("lng")||(b.lat=this.getCenter().lat(),b.lng=this.getCenter().lng()),this.panorama=u.createPanorama(b),this.map.setStreetView(this.panorama),this.panorama},u.createPanorama=function(a){var h=s(a.el,a.context);a.position=new google.maps.LatLng(a.lat,a.lng),delete a.el,delete a.context,delete a.lat,delete a.lng;for(var i=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],j=m({visible:!0},a),k=0;k<i.length;k++){delete j[i[k]]}for(var l=new google.maps.StreetViewPanorama(h,j),k=0;k<i.length;k++){!function(b,d){a[d]&&google.maps.event.addListener(b,d,function(){a[d].apply(this)})}(l,i[k])}return l},u.prototype.on=function(c,d){return u.on(c,this,d)},u.prototype.off=function(b){u.off(b,this)},u.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"],u.on=function(f,g,h){if(-1==u.custom_events.indexOf(f)){return g instanceof u&&(g=g.map),google.maps.event.addListener(g,f,h)}var i={handler:h,eventName:f};return g.registered_events[f]=g.registered_events[f]||[],g.registered_events[f].push(i),i},u.off=function(c,d){-1==u.custom_events.indexOf(c)?(d instanceof u&&(d=d.map),google.maps.event.clearListeners(d,c)):d.registered_events[c]=[]},u.fire=function(f,g,h){if(-1==u.custom_events.indexOf(f)){google.maps.event.trigger(g,f,Array.prototype.slice.apply(arguments).slice(2))}else{if(f in h.registered_events){for(var i=h.registered_events[f],j=0;j<i.length;j++){!function(d,k,l){d.apply(k,[l])}(i[j].handler,h,g)}}}},u.geolocate=function(c){var d=c.always||c.complete;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){c.success(a),d&&d()},function(a){c.error(a),d&&d()},c.options):(c.not_supported(),d&&d())},u.geocode=function(c){this.geocoder=new google.maps.Geocoder;var d=c.callback;c.hasOwnProperty("lat")&&c.hasOwnProperty("lng")&&(c.latLng=new google.maps.LatLng(c.lat,c.lng)),delete c.lat,delete c.lng,delete c.callback,this.geocoder.geocode(c,function(b,f){d(b,f)})},google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(g){for(var h,i=new google.maps.LatLngBounds,j=this.getPaths(),k=0;k<j.getLength();k++){h=j.getAt(k);for(var l=0;l<h.getLength();l++){i.extend(h.getAt(l))}}return i}),google.maps.Polygon.prototype.containsLatLng||(google.maps.Polygon.prototype.containsLatLng=function(l){var x=this.getBounds();if(null!==x&&!x.contains(l)){return !1}for(var y=!1,z=this.getPaths().getLength(),A=0;z>A;A++){for(var B=this.getPaths().getAt(A),C=B.getLength(),D=C-1,E=0;C>E;E++){var F=B.getAt(E),G=B.getAt(D);(F.lng()<l.lng()&&G.lng()>=l.lng()||G.lng()<l.lng()&&F.lng()>=l.lng())&&F.lat()+(l.lng()-F.lng())/(G.lng()-F.lng())*(G.lat()-F.lat())<l.lat()&&(y=!y),D=E}}return y}),google.maps.Circle.prototype.containsLatLng||(google.maps.Circle.prototype.containsLatLng=function(b){return google.maps.geometry?google.maps.geometry.spherical.computeDistanceBetween(this.getCenter(),b)<=this.getRadius():!0}),google.maps.LatLngBounds.prototype.containsLatLng=function(b){return this.contains(b)},google.maps.Marker.prototype.setFences=function(b){this.fences=b},google.maps.Marker.prototype.addFence=function(b){this.fences.push(b)},google.maps.Marker.prototype.getId=function(){return this.__gm_id},Array.prototype.indexOf||(Array.prototype.indexOf=function(f){if(null==this){throw new TypeError}var g=Object(this),h=g.length>>>0;if(0===h){return -1}var i=0;if(arguments.length>1&&(i=Number(arguments[1]),i!=i?i=0:0!=i&&i!=1/0&&i!=-(1/0)&&(i=(i>0||-1)*Math.floor(Math.abs(i)))),i>=h){return -1}for(var j=i>=0?i:Math.max(h-Math.abs(i),0);h>j;j++){if(j in g&&g[j]===f){return j}}return -1}),u});